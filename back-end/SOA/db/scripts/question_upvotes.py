# random datetime between two other: https://stackoverflow.com/questions/553303/generate-a-random-date-between-two-other-dates

import random
import os
from datetime import datetime
from datetime import timedelta

fileDir = os.path.dirname(os.path.realpath('__file__'))
filename = os.path.join(fileDir, '../sql/question_upvotes.sql')
filename = os.path.abspath(os.path.realpath(filename))
f = open(filename, "a", encoding='utf-8')

def dateTimeGen(datetim1, datetim2):
    datetim = max(datetim1, datetim2)
    date = datetim.split(' ')[0]
    time = datetim.split(' ')[1]
    dateparts = date.split('-')
    year = dateparts[0]
    month = dateparts[1]
    day = dateparts[2]
    timeparts = time.split(':')
    hours = timeparts[0]
    mins = timeparts[1]
    secs = timeparts[2]

    start = datetime(int(year), int(month), int(day), int(hours), int(mins), int(secs))
    end = datetime(2021, 6, 30, 22, 30, 30)
    delta = end-start
    int_delta = (delta.days * 24 * 60 * 60) + delta.seconds
    random_second = random.randrange(int_delta)
    return start+timedelta(seconds=random_second)

questions = [
    [1,	"2020-07-31 07:12:53"],
    [2,	"2021-01-26 08:34:15"],
    [3,	"2021-03-11 23:30:13"],
    [4,	"2021-04-20 00:43:03"],
    [5,	"2021-05-23 13:32:22"],
    [6,	"2021-03-17 15:29:03"],
    [7,	"2021-04-21 10:08:20"],
    [8,	"2021-05-04 17:03:58"],
    [9,	"2021-01-18 07:19:04"],
    [10,	"2021-03-22 08:15:52"],
    [11,	"2021-05-12 01:52:33"],
    [12,	"2021-06-16 06:25:36"],
    [13,	"2020-10-21 02:47:06"],
    [14,	"2021-06-07 14:21:40"],
    [15,	"2021-02-25 11:40:20"],
    [16,	"2021-06-20 01:50:54"],
    [17,	"2021-05-05 20:30:20"],
    [18,	"2021-02-17 03:40:36"],
    [19,	"2021-06-05 14:15:37"],
    [20,	"2021-05-27 19:11:05"],
    [21,	"2021-05-02 09:27:03"],
    [22,	"2020-07-02 06:51:08"],
    [23,	"2021-05-12 16:50:53"],
    [24,	"2020-11-14 16:00:59"],
    [25,	"2021-06-19 18:30:44"],
    [26,	"2021-05-14 04:54:13"],
    [27,	"2020-12-15 20:29:29"],
    [28,	"2021-05-27 05:37:01"],
    [29,	"2021-04-24 21:21:38"],
    [30,	"2021-06-23 15:55:57"],
    [31,	"2021-06-06 09:59:15"],
    [32,	"2020-11-17 07:29:56"],
    [33,	"2020-09-23 04:18:58"],
    [34,	"2021-05-21 00:32:49"],
    [35,	"2021-04-02 08:22:16"],
    [36,	"2021-05-16 21:53:43"],
    [37,	"2021-03-16 19:35:33"],
    [38,	"2020-05-30 15:14:52"],
    [39,	"2021-06-07 18:02:39"],
    [40,	"2021-06-24 11:25:23"],
    [41,	"2021-03-17 02:40:08"],
    [42,	"2021-06-29 15:36:42"],
    [43,	"2021-04-05 05:56:26"],
    [44,	"2021-03-23 01:45:41"],
    [45,	"2021-04-26 22:52:01"],
    [46,	"2020-12-31 13:09:55"],
    [47,	"2021-02-03 23:17:19"],
    [48,	"2021-06-04 07:26:07"],
    [49,	"2021-06-27 06:36:31"],
    [50,	"2021-06-19 06:32:33"],
    [51,	"2021-06-24 07:42:10"],
    [52,	"2021-01-21 12:04:38"],
    [53,	"2021-02-20 23:38:54"],
    [54,	"2021-05-21 23:39:07"],
    [55,	"2021-05-14 15:17:55"],
    [56,	"2021-05-04 19:47:18"],
    [57,	"2021-02-17 13:24:32"],
    [58,	"2020-12-18 21:44:42"],
    [59,	"2021-05-14 06:59:49"],
    [60,	"2021-05-11 16:42:33"],
    [61,	"2021-04-16 09:48:56"],
    [62,	"2021-04-29 10:52:47"],
    [63,	"2021-02-02 04:17:53"],
    [64,	"2020-09-27 05:36:34"],
    [65,	"2021-02-19 07:00:29"],
    [66,	"2021-03-03 16:33:30"],
    [67,	"2021-06-27 03:52:00"],
    [68,	"2021-05-02 04:12:01"],
    [69,	"2021-04-01 00:09:30"],
    [70,	"2021-02-21 10:58:07"],
    [71,	"2021-06-02 15:09:43"],
    [72,	"2021-06-30 15:56:43"],
    [73,	"2021-06-22 05:03:43"],
    [74,	"2021-05-09 17:09:20"],
    [75,	"2020-12-15 13:54:43"],
    [76,	"2021-05-24 22:44:23"],
    [77,	"2021-02-05 07:56:12"],
    [78,	"2021-05-19 02:31:44"],
    [79,	"2021-03-23 18:25:51"],
    [80,	"2021-05-18 19:04:59"],
    [81,	"2021-05-15 07:44:36"],
    [82,	"2020-09-15 09:25:44"],
    [83,	"2021-05-08 06:20:04"],
    [84,	"2021-04-15 17:00:31"],
    [85,	"2021-05-25 13:16:30"],
    [86,	"2021-03-19 02:05:59"],
    [87,	"2020-11-28 16:25:01"],
    [88,	"2021-05-17 10:54:20"],
    [89,	"2021-04-01 22:41:17"],
    [90,	"2021-03-11 23:50:08"],
    [91,	"2021-04-09 07:27:10"],
    [92,	"2021-06-14 19:02:29"],
    [93,	"2021-04-04 18:03:17"],
    [94,	"2021-04-20 12:24:15"],
    [95,	"2020-12-30 04:42:02"],
    [96,	"2020-08-05 02:28:22"],
    [97,	"2021-05-26 19:08:38"],
    [98,	"2021-01-03 18:19:25"],
    [99,	"2021-05-24 02:18:17"],
    [100,	"2021-02-05 19:10:02"],
    [101,	"2020-11-09 20:12:13"],
    [102,	"2021-06-13 16:05:39"],
    [103,	"2021-04-17 01:23:52"],
    [104,	"2021-06-15 01:09:53"],
    [105,	"2021-06-30 21:32:03"],
    [106,	"2020-07-21 03:32:35"],
    [107,	"2021-05-30 11:30:20"],
    [108,	"2021-06-07 02:08:08"],
    [109,	"2021-02-28 09:07:33"],
    [110,	"2021-05-12 05:23:15"],
    [111,	"2021-06-22 19:56:32"],
    [112,	"2020-10-03 22:33:25"],
    [113,	"2021-05-18 18:18:47"],
    [114,	"2021-05-01 23:59:20"],
    [115,	"2021-02-05 22:32:13"],
    [116,	"2021-05-19 08:13:08"],
    [117,	"2021-04-19 12:49:07"],
    [118,	"2021-06-29 07:37:55"],
    [119,	"2021-06-17 09:57:15"],
    [120,	"2021-04-24 12:32:41"],
    [121,	"2021-05-10 04:14:46"],
    [122,	"2021-01-30 08:12:25"],
    [123,	"2021-06-11 12:13:37"],
    [124,	"2020-09-01 00:06:23"],
    [125,	"2021-02-25 15:50:09"],
    [126,	"2021-01-31 09:35:58"],
    [127,	"2021-01-29 08:15:48"],
    [128,	"2021-04-15 07:50:42"],
    [129,	"2021-06-04 04:47:25"],
    [130,	"2021-05-31 00:41:45"],
    [131,	"2021-06-24 12:10:07"],
    [132,	"2021-06-23 01:02:54"],
    [133,	"2021-01-28 23:51:35"] ]

users = [
    [1,	 "2021-04-19"],
    [2,	 "2020-10-08"],
    [3,	 "2020-04-20"],
    [4,	 "2021-01-15"],
    [5,	 "2020-11-05"],
    [6,	 "2021-02-01"],
    [7,	 "2021-01-19"],
    [8,	 "2020-12-18"],
    [9,	 "2021-01-04"],
    [10, "2021-03-07"],
    [11, "2020-05-08"],
    [12, "2020-07-04"],
    [13, "2021-05-28"],
    [14, "2021-04-20"],
    [15, "2021-05-18"],
    [16, "2020-06-27"],
    [17, "2020-02-15"],
    [18, "2021-05-02"],
    [19, "2021-02-17"],
    [20, "2020-04-11"],
    [21, "2021-02-18"],
    [22, "2021-01-01"],
    [23, "2020-09-13"],
    [24, "2020-02-13"],
    [25, "2021-05-26"],
    [26, "2021-03-06"],
    [27, "2021-04-09"],
    [28, "2020-12-03"],
    [29, "2020-11-07"],
    [30, "2021-03-28"],
    [31, "2020-11-12"],
    [32, "2021-05-28"],
    [33, "2020-04-17"],
    [34, "2020-02-16"],
    [35, "2021-03-28"],
    [36, "2021-02-16"],
    [37, "2021-02-28"],
    [38, "2021-05-13"],
    [39, "2021-01-19"],
    [40, "2021-01-02"],
    [41, "2020-09-15"],
    [42, "2021-04-12"],
    [43, "2020-03-15"],
    [44, "2021-05-11"],
    [45, "2020-12-25"],
    [46, "2020-10-09"],
    [47, "2020-04-11"],
    [48, "2021-04-11"],
    [49, "2020-10-17"]  ]

prefix = "INSERT INTO public.\"questionupvote\"(user_id, question_id, date) VALUES("

for user in users:
    user_id = user[0]
    user_date = user[1]
    questions_up = random.sample(questions, random.randrange(1,5))
    for question in questions_up:
        question_id = question[0]
        date = dateTimeGen(question[1], user[1]+" 00:00:00")
        f.write(f"{prefix}{str(user_id)}, {str(question_id)}, '{date}');\n")